<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
<title>Contributions:MicromedADC - BCI2000 Help</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Contributions:MicromedADC,Contributions:ADCs,User Reference:Filters" />
<link rel="shortcut icon" href="../../favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../skins/common/wikiprintable.css' />
<link rel="stylesheet" href="../skins/common/wikistandard.css@1" type="text/css" />
<link rel="stylesheet" href="../skins/common/common.css" type="text/css" />
<link rel="stylesheet" href="../skins/common/htmlhelp.css" type="text/css" />

<style type='text/css'>
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px;  }
#article { margin-left: 152px; margin-right: 4px; }
</style>
</head>

<body bgcolor='#FFFFFF'>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
</tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">MicromedADC</h1><p class="subtitle">Contributions</p><hr class="sep" /><table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#Location"><span class="tocnumber">2</span> <span class="toctext">Location</span></a></li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#Versioning"><span class="tocnumber">3</span> <span class="toctext">Versioning</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#Author"><span class="tocnumber">3.1</span> <span class="toctext">Author</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#Version_History"><span class="tocnumber">3.2</span> <span class="toctext">Version History</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#Source_Code_Revisions"><span class="tocnumber">3.3</span> <span class="toctext">Source Code Revisions</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#Functional_Description"><span class="tocnumber">4</span> <span class="toctext">Functional Description</span></a></li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#Installation"><span class="tocnumber">5</span> <span class="toctext">Installation</span></a></li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#Parameters"><span class="tocnumber">6</span> <span class="toctext">Parameters</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#NotchFilter"><span class="tocnumber">6.1</span> <span class="toctext">NotchFilter</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#SampleBlockSize"><span class="tocnumber">6.2</span> <span class="toctext">SampleBlockSize</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#SamplingRate"><span class="tocnumber">6.3</span> <span class="toctext">SamplingRate</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#ServerAddress"><span class="tocnumber">6.4</span> <span class="toctext">ServerAddress</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#Packet_Rate"><span class="tocnumber">6.5</span> <span class="toctext">Packet Rate</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#SignalType"><span class="tocnumber">6.6</span> <span class="toctext">SignalType</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#Condition_Mask"><span class="tocnumber">6.7</span> <span class="toctext">Condition Mask</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#Priority"><span class="tocnumber">6.8</span> <span class="toctext">Priority</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#SourceCh"><span class="tocnumber">6.9</span> <span class="toctext">SourceCh</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#States"><span class="tocnumber">7</span> <span class="toctext">States</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#MicromedCode"><span class="tocnumber">7.1</span> <span class="toctext">MicromedCode</span></a></li>
<li class='toclevel-2'><a href="Contributions%253AMicromedADC.html#MicromedCondition"><span class="tocnumber">7.2</span> <span class="toctext">MicromedCondition</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253AMicromedADC.html#See_also"><span class="tocnumber">8</span> <span class="toctext">See also</span></a></li>
</ul>
</td></tr></table>
<a name="Synopsis"></a><h2>Synopsis</h2>
<p>This module can be used to read data sent over TCP/IP from a Micromed acquisition unit running SystemPLUS Rev. 1.02.1056.
</p>
<a name="Location"></a><h2>Location</h2>
<p><a href="http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/Micromed" class='external free' title="http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/Micromed" rel="nofollow">http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/Micromed</a>
</p>
<a name="Versioning"></a><h2>Versioning</h2>
<a name="Author"></a><h3>Author</h3>
<p>Erik J. Aarnoutse
Rudolf Magnus Institute, UMC Dept. Psychiatry, Utrecht, The Netherlands
May 19, 2006
</p>
<a name="Version_History"></a><h3>Version History</h3>
<p>V0.01 - 19/04/2006 - First working version, based on Neusoscan.exe
</p><p>V0.02 - 08/05/2006 - Added condition testing, 22bit mode and downsampling
</p><p>V0.03 - 17/05/2006 - Added notchfilter
</p><p>V0.04 - 19/09/2006 - Added digital trigger packets, changed note packet
</p><p>V0.05 - 27/11/2006 - Added Priority, fixed digital trigger code
</p><p>V0.06 - 13/03/2007 - Added note output in textfile
</p><p>V0.07 - 04/04/2007 - Added error handling: server shuts down if stalling
</p><p>V2.00 - 29/06/2008 - Updated for BCI2000 v2.0
</p>
<a name="Source_Code_Revisions"></a><h3>Source Code Revisions</h3>
<p>(In this section, indicate the BCI2000 source code revisions (changesets) 
that you used when developing your contribution, and information about 
testing/compilation. Adapt the list to your own needs. 
Hint: You obtain the revision of a source code repository by 
right-clicking its top level directory, and choosing "show log" from the 
TortoiseSVN submenu.)
</p>
<ul><li>Initial development: 1126
</li><li>Tested under: 1126
</li><li>Known to compile under: 2040
</li><li>Broken since: --
</li></ul>
<a name="Functional_Description"></a><h2>Functional Description</h2>
<p>The BCI source module that receives the data from the acquisition is the server, so it must be in listening mode before the acquisition unit starts to save data (data is sent only during recording). Micromed sends 64 data packets per second for SD, 32 for LTM. The connection is reset if the computer running BCI2000 is too slow to read all packets. This happens gracefully in version 2.0. Make sure you have SystemPlus 1.02.1091 or higher, in this version Micromed also gracefully closes the TCP/IP connection at BCI2000 errors.
A packet of data is structured in 2 sections the first is the header and the second is information data. The first packet sent from the client is the header of an EEG Micromed trace and is read for condition checking. If a note is added in SystemPLUS it is sent as a note packet to the source module. If a digital trigger is sent the trigger code is sent to the source module in two ways: the complete code and a bitmasked code. This allows to send information on a condition (eg in SIGFRIED) and extra information for offline analysis.
The header packet and the data packets are in the same format as in a Micromed trace file. The note packet sends the complete note buffer, and written in a textfile with the Micromed Sample Number.
</p>
<a name="Installation"></a><h2>Installation</h2>
<p>To activate data transfer via TCP, it is necessary to add 3 registry keys on the acquisition unit under <tt>HKEY_CURRENT_USER\Software\VB and VBA Program Settings\Brain Quick - System 98\EEG_Settings</tt>:
</p>
<ol><li>"tcpSendAcq" is a string type key which must be set to "1" to activate data transfer via TCP, and to "0" to deactivate it
</li><li>"tcpServerName" is a string type key that represents the IP address of the computer to receive EEG data.
</li><li>"tcpPortNumber" is a string type key that represents the port number used (e.g., "5000").
</li></ol>
<a name="Parameters"></a><h2>Parameters</h2>
<a name="NotchFilter"></a><h3>NotchFilter</h3>
<p>Power line notch filter.
</p>
<ul><li>0: disabled,
</li><li>1: at 50 Hz,
</li><li>2: at 60 Hz
</li></ul>
<a name="SampleBlockSize"></a><h3>SampleBlockSize</h3>
<p>The number of samples transmitted at a time in the BCI2000 system. If SampleBlockSize is a multiple of SamplingRate/64, data packets are merged. This way the BCI system can run on less than 64 sampleblocks per second, which saves CPU power.
</p>
<a name="SamplingRate"></a><h3>SamplingRate</h3>
<p>The sample rate set by the acquisition unit.
</p>
<a name="ServerAddress"></a><h3>ServerAddress</h3>
<p>Address and port of the BCI Server. You can enter "*:5000" if your port number is 5000. This means that the server listens to all IP addresses, localhost and external. The port number can be set in the acquisition unit by changing the registry setting "tcpPortNumber".
</p>
<a name="Packet_Rate"></a><h3>Packet Rate</h3>
<p>Number of TCP/IP packets per second: 32 for LTM,64 for SD
</p>
<a name="SignalType"></a><h3>SignalType</h3>
<p>Numeric type of output signal:
</p>
<ul><li>0: int16,
</li><li>3: int32. 
</li></ul>
<p>Other values are not allowed. Use 0 for Micromeds 16 bit mode, 3 for 22 bit mode: only the first 22 bits are used, but data packets are filled with 32 bit integers.
</p>
<a name="Condition_Mask"></a><h3>Condition Mask</h3>
<p>Bitmask. Digital trigger code AND Condition Mask equals conditions without extra information. When not used, set to 0xFF.
</p>
<a name="Priority"></a><h3>Priority</h3>
<p>CPU Priority. Default=1, set higher if the CPU load is too heavy.
</p>
<a name="SourceCh"></a><h3>SourceCh</h3>
<p>The number of digitized and stored channels, must match the number of channels in the acquisition unit.
</p>
<a name="States"></a><h2>States</h2>
<a name="MicromedCode"></a><h3>MicromedCode</h3>
<p>The serial code read into the Micromed acquisition computer.
</p>
<a name="MicromedCondition"></a><h3>MicromedCondition</h3>
<p>The MicromedCode bitmasked with ConditionMask. This way you can use the first bits to flag a condition, while changing the MicromedCode for each trial.
</p>
<a name="See_also"></a><h2>See also</h2>
<p><a href="User_Reference%253AFilters.html" title="User Reference:Filters">User Reference:Filters</a>, <a href="Contributions%253AADCs.html" title="Contributions:ADCs">Contributions:ADCs</a>
</p>
<div class="printfooter">
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'></td></tr></table>
</div>
</div>

<div id='quickbar'>
<table class="image"><caption align="bottom"><h2>BCI2000 Help</h2></caption><tr><td><a href="BCI2000_Help.html"><img src='../../images/bci2000logo_small.png' height=100 width=100 alt='[BCI2000 Help]' /></a></td></tr></table>
<hr class='sep' /><a href="User_Tutorial%253ABCI2000_Tour.html">Getting Started</a><br />
<a href="User_Reference%253AContents.html">User Manual</a><br />
<a href="Technical_Reference%253AContents.html">Technical Reference</a><br />
<a href="Programming_Reference%253AContents.html">Programming Manual</a><br />
<a href="Contributions%253AContents.html">Contributions</a><br />
<ul><li><a href="Contributions%253AADCs.html">Data Acquisition</a></li>
<li><a href="Contributions%253AFileWriters.html">File Formats</a></li>
<li><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li>
<li><a href="Contributions%253AApplications.html">Applications</a></li>
<li><a href="Contributions%253ATools.html">Tools</a></li>
</ul><hr class='sep' />
<a href="BCI2000_Glossary.html">BCI2000 Glossary</a><br />
</div>

</body></html>